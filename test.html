<!doctype html>
<html lang="ko">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>DeepLOL 검색 도구</title>
	<style>
		body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; color: #111; }
		.container { max-width: 880px; margin: 0 auto; }
		label { display: block; font-weight: 600; margin: 12px 0 4px; }
		input, select { width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; }
		button { margin-top: 16px; padding: 10px 14px; background: #111; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
		button:disabled { opacity: 0.5; cursor: not-allowed; }
		section { margin-top: 28px; }
		.card { border: 1px solid #eee; border-radius: 12px; padding: 16px; margin-top: 12px; }
		ul { margin: 8px 0 0; padding-left: 20px; }
		.footer { margin-top: 40px; color: #666; font-size: 12px; }
	</style>
</head>
<body>
	<div class="container">
		<h2>DeepLOL.gg 검색</h2>
		<p>https://www.deeplol.gg/summoner/kr/{소환사명} 페이지에서 최근 10게임 AI Score와 마감 티어/레이트를 가져옵니다.</p>

		<label for="backend">Backend URL (예: http://localhost:5000)</label>
		<input id="backend" placeholder="http://172.27.79.80:5000/" />

		<label for="region">Region</label>
		<select id="region">
			<option value="kr" selected>kr</option>
		</select>

		<label for="summoner">소환사명</label>
		<input id="summoner" placeholder="소환사명을 입력하세요" />

		<button id="fetchBtn">검색 및 가져오기</button>

		<section class="card">
			<h3>최근 10게임 AI Score</h3>
			<div id="aiScores">-</div>
		</section>

		<section class="card">
			<h3>마감 티어/레이트 (최대 3개)</h3>
			<div id="endTier">-</div>
		</section>

		<div class="footer">프론트는 GitHub Pages에서 정적 호스팅 가능합니다. 백엔드는 Flask로 별도 서버에서 실행하세요.</div>
	</div>

	<script>
		const $ = (id) => document.getElementById(id);
		const btn = $("fetchBtn");
		const renderList = (container, items) => {
			if (!items || items.length === 0) {
				container.textContent = "데이터 없음";
				return;
			}
			const ul = document.createElement("ul");
			items.forEach((v) => {
				const li = document.createElement("li");
				li.textContent = typeof v === "string" ? v : (v.text || JSON.stringify(v));
				ul.appendChild(li);
			});
			container.innerHTML = "";
			container.appendChild(ul);
		};

		btn.addEventListener("click", async () => {
			const backend = $("backend").value.trim();
			const region = $("region").value.trim() || "kr";
			const summoner = $("summoner").value.trim();
			if (!backend) { alert("Backend URL을 입력하세요."); return; }
			if (!summoner) { alert("소환사명을 입력하세요."); return; }
			btn.disabled = true;
			try {
				const aiUrl = `${backend}/api/ai-scores?region=${encodeURIComponent(region)}&summoner=${encodeURIComponent(summoner)}`;
				const endUrl = `${backend}/api/end-tier?region=${encodeURIComponent(region)}&summoner=${encodeURIComponent(summoner)}&limit=3`;
				const [aiRes, endRes] = await Promise.all([fetch(aiUrl), fetch(endUrl)]);
				const aiJson = await aiRes.json();
				const endJson = await endRes.json();
				if (aiJson.error) {
					$("aiScores").textContent = `오류: ${aiJson.error}`;
				} else {
					renderList($("aiScores"), aiJson.scores);
				}
				if (endJson.error) {
					$("endTier").textContent = `오류: ${endJson.error}`;
				} else {
					renderList($("endTier"), endJson.items);
				}
			} catch (e) {
				$("aiScores").textContent = "요청 실패";
				$("endTier").textContent = "요청 실패";
			} finally {
				btn.disabled = false;
			}
		});
	</script>
</body>
</html>


